# kube-prometheus-stack values for TSDB comparison tutorial
# Minimal configuration to run alongside Victoria Metrics and Mimir

# Prometheus configuration
prometheus:
  prometheusSpec:
    # Same retention as other TSDBs
    retention: 2h

    # Remote write to Mimir so it actually receives metrics
    remoteWrite:
      - url: http://mimir-gateway.mimir.svc:80/api/v1/push
        headers:
          X-Scope-OrgID: anonymous

    # Resources - baseline for comparison
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 1
        memory: 1Gi

    # Ephemeral storage
    storageSpec: {}

    # Discover ServiceMonitors in all namespaces
    serviceMonitorSelectorNilUsesHelmValues: false
    podMonitorSelectorNilUsesHelmValues: false
    ruleSelectorNilUsesHelmValues: false

    # Scrape interval - same as other TSDBs
    scrapeInterval: 15s
    evaluationInterval: 15s

  service:
    type: LoadBalancer

# Grafana - shared across all TSDBs
grafana:
  enabled: true
  adminPassword: admin

  service:
    type: LoadBalancer

  # Will add additional datasources via ConfigMap
  additionalDataSources: []

  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

# Alertmanager - disabled (experiment param overrides to false anyway)
alertmanager:
  enabled: false

# Prometheus Operator
prometheusOperator:
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

  # Disable TLS for simplicity in tutorial
  tls:
    enabled: false
  admissionWebhooks:
    enabled: false

# Node exporter - disabled to avoid port conflict with other tutorials
nodeExporter:
  enabled: false

# kube-state-metrics - for Kubernetes object metrics
kubeStateMetrics:
  enabled: true

# Disable components not needed for TSDB comparison
kubeApiServer:
  enabled: false
kubelet:
  enabled: false
kubeControllerManager:
  enabled: false
coreDns:
  enabled: false
kubeEtcd:
  enabled: false
kubeScheduler:
  enabled: false
kubeProxy:
  enabled: false

# Default rules - disable to reduce noise
defaultRules:
  create: false
