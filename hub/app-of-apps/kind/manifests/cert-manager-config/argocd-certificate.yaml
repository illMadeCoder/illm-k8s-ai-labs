# TLS Certificate for ArgoCD
#
# Issued by OpenBao internal CA. Includes both external domain and
# internal service names as SANs for zero-trust internal communication.
#
# For production with public access, consider using Let's Encrypt
# (letsencrypt-prod ClusterIssuer) instead.

apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: argocd-server-tls
  namespace: argocd
spec:
  secretName: argocd-server-tls
  duration: 720h    # 30 days
  renewBefore: 360h # Renew 15 days before expiry

  # Common Name (required by OpenBao)
  commonName: argocd-server.argocd.svc.cluster.local

  # Subject Alternative Names - all valid ways to reach ArgoCD
  dnsNames:
    # External domain (for browser/external access)
    - argocd.illmlab.xyz
    # Internal service names (for pod-to-pod communication)
    - argocd-server
    - argocd-server.argocd
    - argocd-server.argocd.svc
    - argocd-server.argocd.svc.cluster.local

  issuerRef:
    name: openbao-pki
    kind: ClusterIssuer
